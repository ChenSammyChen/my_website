---
categories:
- ""
- ""
date: '2020-09-07'
description: Are there obvious suicide/homicide rate differences between races?
draft: false
image: pic04.png
keywords: ""
slug: blog5
title: Comparison of suicide/homicide rates between races
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries,echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(janitor)
library(skimr)
library(vroom)
library(mosaic)
library(here)

#remotes::install_github("kjhealy/socviz")
library(socviz)
```



To make a publication-ready plot using `dplyr` and `ggplot2` skills, we firstly open the journal article "Riddell_Annals_Hom-Sui-Disparities.pdf". Read the abstract and have a look at Figures. The data we need is "CDC_Males.csv".



```{r,}
# Replicate Figure 3

library(dplyr)
library(ggplot2)
library(ggrepel)

white_firearm <- vroom::vroom(here::here("data","CDC_Males.csv")) %>%
  filter(type == 'Firearm' & !(ST %in% c("US", "DC", "HI"))) 


white_firearm_plot <- ggplot(data = white_firearm, aes(x = adjusted.suicide.White, y = adjusted.homicide.White))+
  geom_point(aes(fill = gun.house.prev.category, size = average.pop.white), col = "black", pch = 21, alpha = 0.8)+
  scale_fill_manual(values = c("#fef0d9", "#fdcc8a", "#fc8d59", "#d7301f"))+
  scale_size_area(breaks = c(500000, 1500000, 3000000, 7000000), max_size = 14, labels = c('500k', '1.5m', '3m', '7m'))+
  scale_x_continuous(limits = c(0,30))+
  scale_y_continuous(limits = c(0,5))+
  labs(x = 'White suicide rate (per 100,000 per year)', y = 'White homicide rate (per 100,000 per year)')+
  guides(fill = guide_legend(title = 'Gun ownership',override.aes = list(size = 5), order = 1),
         size = guide_legend(title = 'White population', order = 0))+
  geom_text_repel(aes(label = ST), size = 4.2)+
  geom_text(aes(x = 26, y = 0.5, label = paste0("Spearman's rho:0.74")),check_overlap = TRUE)+
  theme_bw()+
  NULL

white_firearm_plot
           
```


